<!DOCTYPE html>
<html>
    <head>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="20210311_103849min.jpg" as="image">
    <link rel="preload" href="20210311_121805min.jpg" as="image">
    <link rel="preload" href="3R5A0520_editedmin.jpg" as="image">
    <link rel="preload" href="3R5A0673min.JPG" as="image">
    <link rel="preload" href="3R5A0832min.JPG" as="image">
    <link rel="preload" href="3R5A0552min.JPG" as="image">
    <link rel="preload" href="Horse and Clock Tower.jpg" as="image">
    <link rel="preload" href="3R5A052.png" as="image">
    <link href="nstyle.css" rel="stylesheet" type="text/css">
    <title id="titlech">Academic Award</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&amp;display=swap" rel="stylesheet">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
  </head>
  <body cz-shortcut-listen="true">
    <div id="heading">
        <div id="mnavbar">
            <a>
                <div class="container">
                    <div class="bar1"></div>
                    <div class="bar2"></div>
                    <div class="bar3"></div>
                </div>
            </a>
            <img src="hcilogo.png" id='Home'>
        </div>
        <img id="headingphoto" src="20210311_121805min.jpg">
        <p id="title">Academic Award</p>
    </div>
    <div id="msidebar">
        <div style="margin-top: 50px;"><a class="fordrop" style="color: black;">Prize-Giving Ceremony</a>
            <div class="dropdown" style="display: none;">
                <a class="option" id='Principal Address'>Principal's Address</a>
                <a class="option" id='Alumnus Speech'>Alumni's Speeches</a>
                <a class="option" id='Prize Giving'>Prize Giving</a>
                <a class="option" id='Valedictorian Speech'>Valedictorian's Speech</a>
                <a class="option" id='Gratitude Video'>Gratitude Video</a>
            </div>
            </div>
            <div><a class="fordrop" style="color: black;">Awards</a>
              <div class="dropdown" style="display: none;">
                <a class="option" id='IHC Award'>IHC Award</a>
                <a class="option" id='Xue Yong Shu Model Student Award'>Xue Yong Shu Model Student Award</a>
                <a class="option" id='Zheng An Lun Model Student Award'>Zheng An Lun Model Student Award</a>
                <a class="option" id='All-Round Excellence Award'>ARE</a>
                <a class="option" id='Outstanding Student Award'>OSA</a>
                <a class="option" id='Huangfu Award'>Huangfu Award</a>
                <a class="option" id='Chew Hean Swee Award'>Chew Hean Swee Award</a>
              </div>
            </div>
            <div><a class="fordrop" style="color: black;">Academic Awards</a>
              <div class="dropdown" style="display: none;">
                <a class="option" id='Top in Level'>Top in Level</a>
                <a class="option" id='Top in Subject'>Top in Subject</a>
                <a class="option" id='Bilingual Award'>Bilingual Award</a>
                <a class="option" id='Trilingual Award'>Trilingual Award</a>
              </div>
          </div>
    </div>
    <div id="main">
        <div class="awrpsb">
            <p>Award Recipients:</p>
            <input class="searchbar" placeholder="Search"><a id="closebtn">&times;</a>
        </div>
        <div class="grid">
        </div>
    </div>  
    <script src="nscript.js"></script>
    <script>
    searchbaractive();
    const getFolder = async (path, id, name, formClass) => {
        response = await fetch(path)
        text = await response.text()
        return [text, id, name, formClass]
    }
    const getData = async () => {
        response = await fetch('Academic Awardees.json');
        data = await response.json();
        return data
    }
    getData()
        .then(data => {
            ol = document.querySelector(".grid");
            for (i of data){
                name = i["Full name (According to ISP)"]
                formClass = i["Form Class in 2022"]
                ResponseId = i["Response ID"]
                folderPath = `Academic Awardee/RefNo ${ResponseId}`
                getFolder(folderPath, ResponseId, name, formClass)
                    .then(res => {
                        [text, ResponseId, name, formClass] = res
                        li = document.createElement("div");
                        li.classList.add("obj");
                        img = document.createElement("img");
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(text, 'text/html');
                        const files = [...htmlDoc.getElementsByTagName('a')].map(a => a.textContent)
                        const file = files.at(4);
                        if(file.toLowerCase().includes('.png')){
                            index = file.toLowerCase().indexOf('.png')+4;
                        }
                        else if(file.includes('.jpeg')){
                            index = file.indexOf('.jpeg')+5;
                        }
                        else {
                            index = file.toLowerCase().indexOf('.jpg'||'.JPG')+4;
                        }
                        trimmedFile = file.substring(0,index);
                        if(trimmedFile == "Que"){
                            console.log(file)
                        }
                        img.src = `Academic Awardees/RefNo ${ResponseId}` + "/" + trimmedFile;
                        p = document.createElement("p");
                        br = document.createElement("br");
                        p.append(document.createTextNode(name.toUpperCase()));
                        p.append(br);
                        p.append(document.createTextNode(`Class ${formClass.toUpperCase()} in 2022`));
                        li.append(img);
                        li.append(p);
                        ol.append(li);
                })
            }
        })
  </script>
</body>
</html>
